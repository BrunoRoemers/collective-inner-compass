// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  // NOTE: using SQLite for development and e.g. cockroachdb for production is
  //       not officially supported, see: https://github.com/prisma/prisma/issues/3834
  provider = "cockroachdb"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid()) @db.Uuid
  name      String
  email     String
  answers   Answer[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Questionnaire {
  id        String   @id @default(uuid()) @db.Uuid
  name      String
  fields    Field[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Field {
  id              String        @id @default(uuid()) @db.Uuid
  questionnaire   Questionnaire @relation(fields: [questionnaireId], references: [id])
  questionnaireId String        @db.Uuid
  type            FieldType
  params          Json
  answers         Answer[]
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
}

enum FieldType {
  NUMBER
}

model Answer {
  field     Field    @relation(fields: [fieldId], references: id)
  fieldId   String   @db.Uuid
  user      User     @relation(fields: [userId], references: [id])
  userId    String   @db.Uuid
  data      Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@id([userId, fieldId])
}
